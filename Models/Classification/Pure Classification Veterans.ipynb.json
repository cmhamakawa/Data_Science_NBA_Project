{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "%matplotlib inline\n",
    "import seaborn as sns\n",
    "import sklearn\n",
    "from sklearn.preprocessing import StandardScaler, LabelEncoder\n",
    "from sklearn.cluster import KMeans\n",
    "from sklearn import metrics\n",
    "from sklearn.cluster import AgglomerativeClustering"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "np.random.seed(4242)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "pd.set_option('display.max_columns', None)\n",
    "pd.options.mode.chained_assignment = None "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "import numpy as np\n",
    "import sklearn.preprocessing, sklearn.decomposition, sklearn.linear_model, sklearn.pipeline, sklearn.metrics\n",
    "from sklearn.feature_extraction.text import CountVectorizer\n",
    "from sklearn_pandas import DataFrameMapper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Unnamed: 0</th>\n",
       "      <th>SalStartYr</th>\n",
       "      <th>Salary</th>\n",
       "      <th>GS</th>\n",
       "      <th>MP</th>\n",
       "      <th>FG</th>\n",
       "      <th>FGA</th>\n",
       "      <th>FG%</th>\n",
       "      <th>3P</th>\n",
       "      <th>3PA</th>\n",
       "      <th>3P%</th>\n",
       "      <th>2P</th>\n",
       "      <th>2PA</th>\n",
       "      <th>2P%</th>\n",
       "      <th>eFG%</th>\n",
       "      <th>FT</th>\n",
       "      <th>FTA</th>\n",
       "      <th>FT%</th>\n",
       "      <th>ORB</th>\n",
       "      <th>DRB</th>\n",
       "      <th>TRB</th>\n",
       "      <th>AST</th>\n",
       "      <th>STL</th>\n",
       "      <th>BLK</th>\n",
       "      <th>TOV</th>\n",
       "      <th>PF</th>\n",
       "      <th>PTS</th>\n",
       "      <th>years_of_exp</th>\n",
       "      <th>salary_cap</th>\n",
       "      <th>Per_of_Salary_Cap</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>7454</td>\n",
       "      <td>2001</td>\n",
       "      <td>5062500.0</td>\n",
       "      <td>12.0</td>\n",
       "      <td>14.5</td>\n",
       "      <td>1.5</td>\n",
       "      <td>3.8</td>\n",
       "      <td>0.387</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.3</td>\n",
       "      <td>0.400</td>\n",
       "      <td>1.3</td>\n",
       "      <td>3.5</td>\n",
       "      <td>0.386</td>\n",
       "      <td>0.405</td>\n",
       "      <td>0.7</td>\n",
       "      <td>1.2</td>\n",
       "      <td>0.583</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.6</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.8</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.4</td>\n",
       "      <td>1.2</td>\n",
       "      <td>1.9</td>\n",
       "      <td>3.8</td>\n",
       "      <td>4</td>\n",
       "      <td>42500000</td>\n",
       "      <td>0.119118</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7455</td>\n",
       "      <td>2001</td>\n",
       "      <td>11250000.0</td>\n",
       "      <td>81.0</td>\n",
       "      <td>40.0</td>\n",
       "      <td>7.5</td>\n",
       "      <td>15.8</td>\n",
       "      <td>0.472</td>\n",
       "      <td>0.1</td>\n",
       "      <td>0.8</td>\n",
       "      <td>0.188</td>\n",
       "      <td>7.3</td>\n",
       "      <td>15.0</td>\n",
       "      <td>0.487</td>\n",
       "      <td>0.477</td>\n",
       "      <td>5.5</td>\n",
       "      <td>6.6</td>\n",
       "      <td>0.834</td>\n",
       "      <td>2.2</td>\n",
       "      <td>6.9</td>\n",
       "      <td>9.1</td>\n",
       "      <td>3.1</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.9</td>\n",
       "      <td>2.9</td>\n",
       "      <td>20.5</td>\n",
       "      <td>5</td>\n",
       "      <td>42500000</td>\n",
       "      <td>0.264706</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>7456</td>\n",
       "      <td>2001</td>\n",
       "      <td>1995741.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>8.7</td>\n",
       "      <td>0.7</td>\n",
       "      <td>2.2</td>\n",
       "      <td>0.321</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0.6</td>\n",
       "      <td>0.250</td>\n",
       "      <td>0.5</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0.350</td>\n",
       "      <td>0.357</td>\n",
       "      <td>0.5</td>\n",
       "      <td>0.7</td>\n",
       "      <td>0.667</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.4</td>\n",
       "      <td>0.6</td>\n",
       "      <td>0.0</td>\n",
       "      <td>1.0</td>\n",
       "      <td>1.1</td>\n",
       "      <td>2.0</td>\n",
       "      <td>6</td>\n",
       "      <td>42500000</td>\n",
       "      <td>0.046959</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>7457</td>\n",
       "      <td>2001</td>\n",
       "      <td>1418400.0</td>\n",
       "      <td>24.0</td>\n",
       "      <td>21.3</td>\n",
       "      <td>3.7</td>\n",
       "      <td>8.8</td>\n",
       "      <td>0.417</td>\n",
       "      <td>0.3</td>\n",
       "      <td>0.7</td>\n",
       "      <td>0.370</td>\n",
       "      <td>3.4</td>\n",
       "      <td>8.1</td>\n",
       "      <td>0.421</td>\n",
       "      <td>0.432</td>\n",
       "      <td>1.9</td>\n",
       "      <td>2.3</td>\n",
       "      <td>0.820</td>\n",
       "      <td>0.6</td>\n",
       "      <td>1.6</td>\n",
       "      <td>2.2</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0.7</td>\n",
       "      <td>0.1</td>\n",
       "      <td>1.2</td>\n",
       "      <td>2.1</td>\n",
       "      <td>9.5</td>\n",
       "      <td>1</td>\n",
       "      <td>42500000</td>\n",
       "      <td>0.033374</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>7458</td>\n",
       "      <td>2001</td>\n",
       "      <td>11250000.0</td>\n",
       "      <td>82.0</td>\n",
       "      <td>38.2</td>\n",
       "      <td>7.7</td>\n",
       "      <td>16.0</td>\n",
       "      <td>0.480</td>\n",
       "      <td>2.5</td>\n",
       "      <td>5.7</td>\n",
       "      <td>0.433</td>\n",
       "      <td>5.2</td>\n",
       "      <td>10.3</td>\n",
       "      <td>0.506</td>\n",
       "      <td>0.557</td>\n",
       "      <td>4.2</td>\n",
       "      <td>4.8</td>\n",
       "      <td>0.888</td>\n",
       "      <td>1.2</td>\n",
       "      <td>4.0</td>\n",
       "      <td>5.2</td>\n",
       "      <td>4.6</td>\n",
       "      <td>1.5</td>\n",
       "      <td>0.2</td>\n",
       "      <td>2.5</td>\n",
       "      <td>2.3</td>\n",
       "      <td>22.0</td>\n",
       "      <td>5</td>\n",
       "      <td>42500000</td>\n",
       "      <td>0.264706</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   Unnamed: 0  SalStartYr      Salary    GS    MP   FG   FGA    FG%   3P  3PA  \\\n",
       "0        7454        2001   5062500.0  12.0  14.5  1.5   3.8  0.387  0.1  0.3   \n",
       "1        7455        2001  11250000.0  81.0  40.0  7.5  15.8  0.472  0.1  0.8   \n",
       "2        7456        2001   1995741.0   0.0   8.7  0.7   2.2  0.321  0.2  0.6   \n",
       "3        7457        2001   1418400.0  24.0  21.3  3.7   8.8  0.417  0.3  0.7   \n",
       "4        7458        2001  11250000.0  82.0  38.2  7.7  16.0  0.480  2.5  5.7   \n",
       "\n",
       "     3P%   2P   2PA    2P%   eFG%   FT  FTA    FT%  ORB  DRB  TRB  AST  STL  \\\n",
       "0  0.400  1.3   3.5  0.386  0.405  0.7  1.2  0.583  0.5  1.6  2.0  0.8  0.5   \n",
       "1  0.188  7.3  15.0  0.487  0.477  5.5  6.6  0.834  2.2  6.9  9.1  3.1  1.1   \n",
       "2  0.250  0.5   1.5  0.350  0.357  0.5  0.7  0.667  0.0  1.0  1.0  1.4  0.6   \n",
       "3  0.370  3.4   8.1  0.421  0.432  1.9  2.3  0.820  0.6  1.6  2.2  1.0  0.7   \n",
       "4  0.433  5.2  10.3  0.506  0.557  4.2  4.8  0.888  1.2  4.0  5.2  4.6  1.5   \n",
       "\n",
       "   BLK  TOV   PF   PTS  years_of_exp  salary_cap  Per_of_Salary_Cap  \n",
       "0  0.4  1.2  1.9   3.8             4    42500000           0.119118  \n",
       "1  1.0  2.9  2.9  20.5             5    42500000           0.264706  \n",
       "2  0.0  1.0  1.1   2.0             6    42500000           0.046959  \n",
       "3  0.1  1.2  2.1   9.5             1    42500000           0.033374  \n",
       "4  0.2  2.5  2.3  22.0             5    42500000           0.264706  "
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "adv_df = pd.read_csv('https://raw.githubusercontent.com/cmhamakawa/Data_Science_NBA_Project/master/Datasets/preprocessed_nba_dataset(w_years_of_exp).csv')\n",
    "adv_df.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "scrolled": true
   },
   "outputs": [],
   "source": [
    "adv_df.drop(adv_df.columns[0], axis = 1, inplace = True)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [],
   "source": [
    "# getting subset of data which we deemed to be our best columns as predictors of salary\n",
    "christine_subset = adv_df[['FG', 'FTA', 'AST', 'TRB', 'PTS', 'BLK', 'years_of_exp','Salary','SalStartYr','TOV']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [],
   "source": [
    "# getting veterans data \n",
    "christine_subset = christine_subset[christine_subset['years_of_exp'] != 1]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "1987800.0"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#first quartile\n",
    "q1 = christine_subset['Salary'].quantile(.25)\n",
    "q1"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "9265833.0"
      ]
     },
     "execution_count": 11,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#first quartile\n",
    "q3 = christine_subset['Salary'].quantile(.75)\n",
    "q3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "7278033.0"
      ]
     },
     "execution_count": 12,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#interquartile range\n",
    "iqr = q3 - q1\n",
    "iqr"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "-8929249.5"
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#lower limit for outliers, lower than 0 so no need to account for\n",
    "lower = q1 - 1.5 * iqr\n",
    "lower"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "20182882.5"
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#upper limit for outliers\n",
    "upper = q3 + 1.5 * iqr\n",
    "upper"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# removing outliers, aka all stars \n",
    "christine_subset = christine_subset[christine_subset['Salary'] < upper]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn import preprocessing\n",
    "le = preprocessing.LabelEncoder()\n",
    "christine_subset['SalStartYr'] = le.fit_transform(christine_subset['SalStartYr'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.cluster import KMeans\n",
    "from sklearn import metrics\n",
    "from scipy.spatial.distance import cdist\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as pl"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "metadata": {},
   "outputs": [],
   "source": [
    "# getting salary data to be used for clustering\n",
    "to_elbow = pd.DataFrame(christine_subset['Salary'])"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 21,
   "metadata": {},
   "outputs": [],
   "source": [
    "distortions = []\n",
    "inertias = []\n",
    "\n",
    "K = range(1, 10)\n",
    " \n",
    "for k in K:\n",
    "    # Building and fitting the model\n",
    "    kmeanModel = KMeans(n_clusters=k).fit(to_elbow)\n",
    "    kmeanModel.fit(to_elbow)\n",
    " \n",
    "    distortions.append(sum(np.min(cdist(to_elbow, kmeanModel.cluster_centers_,\n",
    "                                        'euclidean'), axis=1)) / to_elbow.shape[0])\n",
    "    \n",
    "    inertias.append(kmeanModel.inertia_)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "# plotting the values to determine point of inflection aka the \"elbow\" of the graphplt.plot(K, distortions, 'bx-')\n",
    "plt.xlabel('Values of K')\n",
    "plt.ylabel('Inertia')\n",
    "plt.title('The Elbow Method using Inertia')\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 4 seemed to be optimal according to the above graph\n",
    "kmeans=KMeans(n_clusters=4,random_state=1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "KMeans(n_clusters=4, random_state=1)"
      ]
     },
     "execution_count": 24,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "kmeans.fit(to_elbow)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "metadata": {},
   "outputs": [],
   "source": [
    "to_elbow['Cluster'] = kmeans.labels_"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0, 3, 2, 1], dtype=int32)"
      ]
     },
     "execution_count": 26,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "to_elbow['Cluster'].unique()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 27,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(5103, 2)"
      ]
     },
     "execution_count": 27,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "to_elbow.shape"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "metadata": {},
   "outputs": [],
   "source": [
    "# adding cluster number column to the original data set\n",
    "christine_subset['Cluster'] = to_elbow['Cluster']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 29,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>FG</th>\n",
       "      <th>FTA</th>\n",
       "      <th>AST</th>\n",
       "      <th>TRB</th>\n",
       "      <th>PTS</th>\n",
       "      <th>BLK</th>\n",
       "      <th>Salary</th>\n",
       "      <th>SalStartYr</th>\n",
       "      <th>TOV</th>\n",
       "      <th>Cluster</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>6217</th>\n",
       "      <td>2.6</td>\n",
       "      <td>1.4</td>\n",
       "      <td>3.3</td>\n",
       "      <td>3.8</td>\n",
       "      <td>6.9</td>\n",
       "      <td>0.3</td>\n",
       "      <td>9000000.0</td>\n",
       "      <td>19</td>\n",
       "      <td>1.0</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6218</th>\n",
       "      <td>4.2</td>\n",
       "      <td>1.1</td>\n",
       "      <td>1.8</td>\n",
       "      <td>4.9</td>\n",
       "      <td>10.3</td>\n",
       "      <td>0.4</td>\n",
       "      <td>13545000.0</td>\n",
       "      <td>19</td>\n",
       "      <td>1.6</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6219</th>\n",
       "      <td>9.1</td>\n",
       "      <td>9.3</td>\n",
       "      <td>9.3</td>\n",
       "      <td>4.3</td>\n",
       "      <td>29.6</td>\n",
       "      <td>0.1</td>\n",
       "      <td>6571800.0</td>\n",
       "      <td>19</td>\n",
       "      <td>4.8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6220</th>\n",
       "      <td>4.3</td>\n",
       "      <td>3.1</td>\n",
       "      <td>1.5</td>\n",
       "      <td>7.1</td>\n",
       "      <td>11.1</td>\n",
       "      <td>0.4</td>\n",
       "      <td>15415730.0</td>\n",
       "      <td>19</td>\n",
       "      <td>1.3</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6221</th>\n",
       "      <td>3.3</td>\n",
       "      <td>2.3</td>\n",
       "      <td>1.1</td>\n",
       "      <td>7.5</td>\n",
       "      <td>8.3</td>\n",
       "      <td>0.9</td>\n",
       "      <td>7000000.0</td>\n",
       "      <td>19</td>\n",
       "      <td>0.8</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "       FG  FTA  AST  TRB   PTS  BLK      Salary  SalStartYr  TOV  Cluster\n",
       "6217  2.6  1.4  3.3  3.8   6.9  0.3   9000000.0          19  1.0        3\n",
       "6218  4.2  1.1  1.8  4.9  10.3  0.4  13545000.0          19  1.6        3\n",
       "6219  9.1  9.3  9.3  4.3  29.6  0.1   6571800.0          19  4.8        0\n",
       "6220  4.3  3.1  1.5  7.1  11.1  0.4  15415730.0          19  1.3        1\n",
       "6221  3.3  2.3  1.1  7.5   8.3  0.9   7000000.0          19  0.8        0"
      ]
     },
     "execution_count": 29,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "christine_subset.tail()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# How Well Can I Predict Clusters?"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "metadata": {},
   "outputs": [],
   "source": [
    "from sklearn.model_selection import train_test_split\n",
    "from sklearn.linear_model import LogisticRegression\n",
    "from sklearn.model_selection import cross_val_score\n",
    "from sklearn.metrics import confusion_matrix\n",
    "from sklearn.tree import DecisionTreeClassifier\n",
    "pd.set_option('display.max_rows', None)\n",
    "import warnings\n",
    "warnings.filterwarnings('ignore')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 32,
   "metadata": {},
   "outputs": [],
   "source": [
    "# setting up predictor and target data \n",
    "X = christine_subset.drop(columns = ['Cluster','Salary'], axis = 1)\n",
    "y = christine_subset[['Cluster']]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 33,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>FG</th>\n",
       "      <th>FTA</th>\n",
       "      <th>AST</th>\n",
       "      <th>TRB</th>\n",
       "      <th>PTS</th>\n",
       "      <th>BLK</th>\n",
       "      <th>SalStartYr</th>\n",
       "      <th>TOV</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>1.5</td>\n",
       "      <td>1.2</td>\n",
       "      <td>0.8</td>\n",
       "      <td>2.0</td>\n",
       "      <td>3.8</td>\n",
       "      <td>0.4</td>\n",
       "      <td>0</td>\n",
       "      <td>1.2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>7.5</td>\n",
       "      <td>6.6</td>\n",
       "      <td>3.1</td>\n",
       "      <td>9.1</td>\n",
       "      <td>20.5</td>\n",
       "      <td>1.0</td>\n",
       "      <td>0</td>\n",
       "      <td>2.9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>0.7</td>\n",
       "      <td>0.7</td>\n",
       "      <td>1.4</td>\n",
       "      <td>1.0</td>\n",
       "      <td>2.0</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>1.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>7.7</td>\n",
       "      <td>4.8</td>\n",
       "      <td>4.6</td>\n",
       "      <td>5.2</td>\n",
       "      <td>22.0</td>\n",
       "      <td>0.2</td>\n",
       "      <td>0</td>\n",
       "      <td>2.5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>0.8</td>\n",
       "      <td>0.4</td>\n",
       "      <td>1.8</td>\n",
       "      <td>0.8</td>\n",
       "      <td>2.1</td>\n",
       "      <td>0.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0.5</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    FG  FTA  AST  TRB   PTS  BLK  SalStartYr  TOV\n",
       "0  1.5  1.2  0.8  2.0   3.8  0.4           0  1.2\n",
       "1  7.5  6.6  3.1  9.1  20.5  1.0           0  2.9\n",
       "2  0.7  0.7  1.4  1.0   2.0  0.0           0  1.0\n",
       "4  7.7  4.8  4.6  5.2  22.0  0.2           0  2.5\n",
       "5  0.8  0.4  1.8  0.8   2.1  0.0           0  0.5"
      ]
     },
     "execution_count": 33,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "X.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "metadata": {},
   "outputs": [],
   "source": [
    "# splitting into testing and training\n",
    "X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.40)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Logistic Regression"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.581506360020898"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "LR = LogisticRegression()\n",
    "cross_val_score(LR, X_train, y_train, cv = 5).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 36,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([0.        , 0.33333333, 0.66666667, 1.        , 1.33333333,\n",
       "       1.66666667, 2.        , 2.33333333, 2.66666667, 3.        ])"
      ]
     },
     "execution_count": 36,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "c_vals = np.linspace(0, 3, 10)\n",
    "c_vals"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 37,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "<matplotlib.collections.PathCollection at 0x12006e6d0>"
      ]
     },
     "execution_count": 37,
     "metadata": {},
     "output_type": "execute_result"
    },
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(1)\n",
    "\n",
    "best_score = 0\n",
    "best_c = 0\n",
    "\n",
    "# c_vals from 0-10\n",
    "c_vals = np.linspace(0, 3, 20)\n",
    "\n",
    "# loop through possible c_vals\n",
    "for c_val in c_vals:\n",
    "    \n",
    "    # evaluate the model with the current c_val\n",
    "    LR = LogisticRegression(C = c_val)\n",
    "    cv_score = cross_val_score(LR, X_train, y_train, cv=5).mean()\n",
    "    ax.scatter(c_val, cv_score, color = \"black\")\n",
    "    \n",
    "    # check if we've beaten our previous score\n",
    "    if cv_score > best_score:\n",
    "        best_c = c_val\n",
    "        best_score = cv_score\n",
    "\n",
    "l = ax.set(title = \"Best C : \" + str(best_c),\n",
    "       xlabel = \"C\", \n",
    "       ylabel = \"CV Score\")\n",
    "ax.scatter(best_c, best_score, color = \"red\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 56,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5841228356746161 0.5435847208619001\n"
     ]
    }
   ],
   "source": [
    "LR = LogisticRegression(C = best_c)\n",
    "LR.fit(X_train, y_train)\n",
    "print(LR.score(X_train,y_train),LR.score(X_test, y_test))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Decision Trees"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 39,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.5396864237810404"
      ]
     },
     "execution_count": 39,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "T = DecisionTreeClassifier(max_depth = 2)\n",
    "cross_val_score(T, X_train, y_train, cv=5).mean()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 40,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "fig, ax = plt.subplots(1)\n",
    "\n",
    "best_score = 0\n",
    "\n",
    "# cross validation for each of the possible model depths 1-30\n",
    "for d in range(1,30):\n",
    "    T = DecisionTreeClassifier(max_depth = d)\n",
    "    # Average cv_score acheived in cross validation\n",
    "    cv_score = cross_val_score(T, X_train, y_train, cv=10).mean()\n",
    "    # plot avg cv_score (in black)\n",
    "    ax.scatter(d, cv_score, color = \"black\")\n",
    "    # identify the best possible depth by cv_score\n",
    "    if cv_score > best_score:\n",
    "        best_depth = d\n",
    "        best_score = cv_score\n",
    "\n",
    "#highlight the best depth, best score value in red\n",
    "ax.scatter(best_depth, best_score, color = \"red\")\n",
    "\n",
    "# show best depth in title \n",
    "# plot tells us the depth that acheived the best score under cross validation \n",
    "# we now have a good estimate about the optimal depth/complexity of model\n",
    "l = ax.set(title = \"Best Depth : \" + str(best_depth),\n",
    "       xlabel = \"Depth\", \n",
    "       ylabel = \"CV Score\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 41,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(0.5775890231950344, 0.5323212536728698)"
      ]
     },
     "execution_count": 41,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "T = DecisionTreeClassifier(max_depth = best_depth)\n",
    "T.fit(X_train, y_train)\n",
    "T.score(X_train, y_train), T.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 42,
   "metadata": {},
   "outputs": [],
   "source": [
    "# import MLPClassifier\n",
    "from sklearn.neural_network import MLPClassifier"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 43,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Iteration 1, loss = 2.82087233\n",
      "Iteration 2, loss = 1.41000771\n",
      "Iteration 3, loss = 1.29333303\n",
      "Iteration 4, loss = 1.22556707\n",
      "Iteration 5, loss = 1.19642075\n",
      "Iteration 6, loss = 1.18248438\n",
      "Iteration 7, loss = 1.16338179\n",
      "Iteration 8, loss = 1.14757996\n",
      "Iteration 9, loss = 1.13255827\n",
      "Iteration 10, loss = 1.11605262\n",
      "Iteration 11, loss = 1.09706443\n",
      "Iteration 12, loss = 1.08219617\n",
      "Iteration 13, loss = 1.07260558\n",
      "Iteration 14, loss = 1.05703257\n",
      "Iteration 15, loss = 1.05113350\n",
      "Iteration 16, loss = 1.03571532\n",
      "Iteration 17, loss = 1.03064688\n",
      "Iteration 18, loss = 1.02216074\n",
      "Iteration 19, loss = 1.01635747\n",
      "Iteration 20, loss = 1.01090824\n",
      "Iteration 21, loss = 1.00899031\n",
      "Iteration 22, loss = 1.00771506\n",
      "Iteration 23, loss = 0.99806335\n",
      "Iteration 24, loss = 0.99549236\n",
      "Iteration 25, loss = 0.99571591\n",
      "Iteration 26, loss = 0.98778913\n",
      "Iteration 27, loss = 0.98670609\n",
      "Iteration 28, loss = 0.98439323\n",
      "Iteration 29, loss = 0.98231237\n",
      "Iteration 30, loss = 0.98295919\n",
      "Iteration 31, loss = 0.97783571\n",
      "Iteration 32, loss = 0.97777714\n",
      "Iteration 33, loss = 0.97674772\n",
      "Iteration 34, loss = 0.97888180\n",
      "Iteration 35, loss = 0.96839443\n",
      "Iteration 36, loss = 0.97188163\n",
      "Iteration 37, loss = 0.96588647\n",
      "Iteration 38, loss = 0.96980622\n",
      "Iteration 39, loss = 0.96798938\n",
      "Iteration 40, loss = 0.96089429\n",
      "Iteration 41, loss = 0.96337297\n",
      "Iteration 42, loss = 0.95983122\n",
      "Iteration 43, loss = 0.96115593\n",
      "Iteration 44, loss = 0.96261491\n",
      "Iteration 45, loss = 0.96145668\n",
      "Iteration 46, loss = 0.96217455\n",
      "Iteration 47, loss = 0.95513274\n",
      "Iteration 48, loss = 0.95642612\n",
      "Iteration 49, loss = 0.95597619\n",
      "Iteration 50, loss = 0.95482385\n",
      "Iteration 51, loss = 0.95534252\n",
      "Iteration 52, loss = 0.95211792\n",
      "Iteration 53, loss = 0.95199871\n",
      "Iteration 54, loss = 0.95437727\n",
      "Iteration 55, loss = 0.95660251\n",
      "Iteration 56, loss = 0.95021395\n",
      "Iteration 57, loss = 0.95060919\n",
      "Iteration 58, loss = 0.95391177\n",
      "Iteration 59, loss = 0.95302867\n",
      "Iteration 60, loss = 0.95035978\n",
      "Iteration 61, loss = 0.94692987\n",
      "Iteration 62, loss = 0.94907168\n",
      "Iteration 63, loss = 0.94523643\n",
      "Iteration 64, loss = 0.94923157\n",
      "Iteration 65, loss = 0.94671176\n",
      "Iteration 66, loss = 0.94566552\n",
      "Iteration 67, loss = 0.94589239\n",
      "Iteration 68, loss = 0.94648147\n",
      "Iteration 69, loss = 0.94366930\n",
      "Iteration 70, loss = 0.94340929\n",
      "Iteration 71, loss = 0.94486085\n",
      "Iteration 72, loss = 0.94872624\n",
      "Iteration 73, loss = 0.95045739\n",
      "Iteration 74, loss = 0.94556656\n",
      "Iteration 75, loss = 0.94431677\n",
      "Iteration 76, loss = 0.94970851\n",
      "Iteration 77, loss = 0.94085559\n",
      "Iteration 78, loss = 0.94801304\n",
      "Iteration 79, loss = 0.94386651\n",
      "Iteration 80, loss = 0.94339787\n",
      "Iteration 81, loss = 0.94263574\n",
      "Iteration 82, loss = 0.94095797\n",
      "Iteration 83, loss = 0.93845578\n",
      "Iteration 84, loss = 0.94316032\n",
      "Iteration 85, loss = 0.94318221\n",
      "Iteration 86, loss = 0.93835279\n",
      "Iteration 87, loss = 0.94159410\n",
      "Iteration 88, loss = 0.93954722\n",
      "Iteration 89, loss = 0.94306599\n",
      "Iteration 90, loss = 0.93999312\n",
      "Iteration 91, loss = 0.94013934\n",
      "Iteration 92, loss = 0.93964112\n",
      "Iteration 93, loss = 0.94403149\n",
      "Iteration 94, loss = 0.93921321\n",
      "Iteration 95, loss = 0.93853404\n",
      "Iteration 96, loss = 0.93661593\n",
      "Iteration 97, loss = 0.93684712\n",
      "Iteration 98, loss = 0.93554379\n",
      "Iteration 99, loss = 0.93659309\n",
      "Iteration 100, loss = 0.93672942\n",
      "Iteration 101, loss = 0.93620141\n",
      "Iteration 102, loss = 0.93803581\n",
      "Iteration 103, loss = 0.93770741\n",
      "Iteration 104, loss = 0.93775392\n",
      "Iteration 105, loss = 0.94125086\n",
      "Iteration 106, loss = 0.93929207\n",
      "Iteration 107, loss = 0.93607704\n",
      "Iteration 108, loss = 0.93413067\n",
      "Iteration 109, loss = 0.93462106\n",
      "Iteration 110, loss = 0.93370959\n",
      "Iteration 111, loss = 0.93187274\n",
      "Iteration 112, loss = 0.93380454\n",
      "Iteration 113, loss = 0.93195949\n",
      "Iteration 114, loss = 0.93489969\n",
      "Iteration 115, loss = 0.93286565\n",
      "Iteration 116, loss = 0.93426044\n",
      "Iteration 117, loss = 0.93343162\n",
      "Iteration 118, loss = 0.93160169\n",
      "Iteration 119, loss = 0.93884420\n",
      "Iteration 120, loss = 0.93183164\n",
      "Iteration 121, loss = 0.93719446\n",
      "Iteration 122, loss = 0.93159892\n",
      "Iteration 123, loss = 0.93188540\n",
      "Iteration 124, loss = 0.93247898\n",
      "Iteration 125, loss = 0.93176776\n",
      "Iteration 126, loss = 0.93172032\n",
      "Iteration 127, loss = 0.93061298\n",
      "Iteration 128, loss = 0.93265672\n",
      "Iteration 129, loss = 0.93185839\n",
      "Iteration 130, loss = 0.92910999\n",
      "Iteration 131, loss = 0.93049868\n",
      "Iteration 132, loss = 0.93012697\n",
      "Iteration 133, loss = 0.93203802\n",
      "Iteration 134, loss = 0.93045721\n",
      "Iteration 135, loss = 0.93209999\n",
      "Iteration 136, loss = 0.93155690\n",
      "Iteration 137, loss = 0.92996870\n",
      "Iteration 138, loss = 0.92784915\n",
      "Iteration 139, loss = 0.93152962\n",
      "Iteration 140, loss = 0.92918453\n",
      "Iteration 141, loss = 0.93322446\n",
      "Iteration 142, loss = 0.93210463\n",
      "Iteration 143, loss = 0.92718921\n",
      "Iteration 144, loss = 0.93400564\n",
      "Iteration 145, loss = 0.93020359\n",
      "Iteration 146, loss = 0.92697044\n",
      "Iteration 147, loss = 0.92606907\n",
      "Iteration 148, loss = 0.93035585\n",
      "Iteration 149, loss = 0.92929885\n",
      "Iteration 150, loss = 0.93157736\n",
      "Iteration 151, loss = 0.93026714\n",
      "Iteration 152, loss = 0.92821945\n",
      "Iteration 153, loss = 0.92754557\n",
      "Iteration 154, loss = 0.93557372\n",
      "Iteration 155, loss = 0.92946029\n",
      "Iteration 156, loss = 0.93402698\n",
      "Iteration 157, loss = 0.93689261\n",
      "Iteration 158, loss = 0.92701499\n",
      "Training loss did not improve more than tol=0.000100 for 10 consecutive epochs. Stopping.\n"
     ]
    }
   ],
   "source": [
    "N = MLPClassifier(verbose = True, max_iter = 1000).fit(X_train, y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 44,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "array([2, 2, 2, ..., 2, 0, 2], dtype=int32)"
      ]
     },
     "execution_count": 44,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "N.predict(X_test)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 45,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0.5475024485798237"
      ]
     },
     "execution_count": 45,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "N.score(X_test, y_test)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Random Forests"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 46,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "image/png": "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\n",
      "text/plain": [
       "<Figure size 432x288 with 1 Axes>"
      ]
     },
     "metadata": {
      "needs_background": "light"
     },
     "output_type": "display_data"
    }
   ],
   "source": [
    "from sklearn.ensemble import RandomForestClassifier\n",
    "\n",
    "fig, ax = plt.subplots(1)\n",
    "\n",
    "best_score = 0\n",
    "\n",
    "# cross validation for each of the possible model depths 1-30\n",
    "for d in range(1,30):\n",
    "    T = RandomForestClassifier(max_depth = d)\n",
    "    # Average cv_score acheived in cross validation\n",
    "    cv_score = cross_val_score(T, X_train, y_train, cv=10).mean()\n",
    "    # plot avg cv_score (in black)\n",
    "    ax.scatter(d, cv_score, color = \"black\")\n",
    "    # identify the best possible depth by cv_score\n",
    "    if cv_score > best_score:\n",
    "        best_depth = d\n",
    "        best_score = cv_score\n",
    "\n",
    "#highlight the best depth, best score value in red\n",
    "ax.scatter(best_depth, best_score, color = \"red\")\n",
    "\n",
    "# show best depth in title \n",
    "# plot tells us the depth that acheived the best score under cross validation \n",
    "# we now have a good estimate about the optimal depth/complexity of model\n",
    "l = ax.set(title = \"Best Depth : \" + str(best_depth),\n",
    "       xlabel = \"Depth\", \n",
    "       ylabel = \"CV Score\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 47,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.7451813132963084 0.5582761998041136\n"
     ]
    }
   ],
   "source": [
    "T = RandomForestClassifier(max_depth = best_depth)\n",
    "T.fit(X_train,y_train)\n",
    "print(T.score(X_train,y_train),T.score(X_test,y_test))"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Support Vector Machine"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 54,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "SVC()"
      ]
     },
     "execution_count": 54,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "from sklearn import svm\n",
    "vector = svm.SVC()\n",
    "vector.fit(X_train,y_train)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 55,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "0.5913100294021562 0.5568070519098922\n"
     ]
    }
   ],
   "source": [
    "print(vector.score(X_train,y_train),vector.score(X_test,y_test))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "colab": {
   "collapsed_sections": [],
   "name": "DSU_NBA_Data_Cleaning.ipynb",
   "provenance": []
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.5"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
